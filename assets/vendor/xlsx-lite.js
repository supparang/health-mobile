(function(w){if(w.XLSX)return;w.XLSX={utils:{book_new(){return{__sheets:{}}},json_to_sheet(a){const k=[...new Set(a.flatMap(o=>Object.keys(o)))];const data=[k].concat(a.map(o=>k.map(x=>o[x])));return{__csv:data.map(r=>r.join(',')).join('\n')}} ,book_append_sheet(wb,s,n){wb.__sheets[n]=s.__csv}},writeFile(wb,fn){const n=Object.keys(wb.__sheets)[0]||'Sheet1';const csv=wb.__sheets[n]||'';const b=new Blob([csv],{type:'text/csv'});const a=document.createElement('a');a.href=URL.createObjectURL(b);a.download=fn.replace(/\.xlsx$/i,'.csv');a.click();}}})(window);